<?xml version="1.0"?>
<topology>
	<gateway>
		<provider>
			<role>authorization</role>
			<name>AclsAuthz</name>
			<enabled>true</enabled>
			<param>
				<name>acl.mode</name>
				<value>AND</value>
			</param>
			<param>
				<name>webhdfs.acl.mode</name>
				<value>OR</value>
			</param>
			<param>
				<name>webhdfs.acl</name>
				<value>guest;admin;127.0.0.2,127.0.0.3</value>
			</param>
			<param>
				<name>hive.acl</name>
				<value>admin;*;*</value>
			</param>
		</provider>
		<provider>
			<role>authentication</role>
			<name>ShiroProvider</name>
			<enabled>true</enabled>
			<param>
				<!--
                session timeout in minutes,  this is really idle timeout,
                defaults to 30mins, if the property value is not defined,,
                current client authentication would expire if client idles contiuosly for more than this value
                -->
				<name>sessionTimeout</name>
				<value>30</value>
			</param>
			<param>
				<name>main.ldapRealm</name>
				<value>org.apache.knox.gateway.shirorealm.KnoxLdapRealm</value>
			</param>
			<param>
				<name>main.ldapContextFactory</name>
				<value>org.apache.knox.gateway.shirorealm.KnoxLdapContextFactory</value>
			</param>
			<param>
				<name>main.ldapRealm.contextFactory</name>
				<value>$ldapContextFactory</value>
			</param>
			<param>
				<name>main.ldapRealm.userDnTemplate</name>
				<value>uid={0},ou=people,dc=hadoop,dc=apache,dc=org</value>
			</param>
			<param>
				<name>main.ldapRealm.contextFactory.url</name>
				<value>ldap://localhost:33389</value>
			</param>
			<param>
				<name>main.ldapRealm.contextFactory.authenticationMechanism</name>
				<value>simple</value>
			</param>
			<param>
				<name>urls./**</name>
				<value>authcBasic</value>
			</param>
		</provider>
		<provider>
			<role>identity-assertion</role>
			<name>Default</name>
			<enabled>true</enabled>
		</provider>
		<provider>
			<role>hostmap</role>
			<name>static</name>
			<enabled>true</enabled>
			<param>
				<name>localhost</name>
				<value>dataproc</value>
			</param>
		</provider>
	</gateway>
	<service>
		<role>WEBHDFS</role>
		<!-- HA clusters bind the services to the ip address of master
			So you should not use "localhost" for them
		 -->
		<url>http://localhost:9870/webhdfs</url>
	</service>
	<service>
		<role>HIVE</role>
		<url>http://localhost:10000/cliservice</url>
	</service>
</topology>
